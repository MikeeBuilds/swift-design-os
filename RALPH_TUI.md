# Ralph TUI Integration

This document explains the Ralph TUI integration in Swift DesignOS.

## What is Ralph TUI?

Ralph TUI is an AI agent loop orchestrator that helps with autonomous development. It provides:

- **Planning Phase**: AI-driven PRD generation and atomic task creation
- **Execution Loop**: Orchestrates autonomous AI coding agents
- **Real-time Visibility**: TUI interface for monitoring agent activity
- **Task Tracking**: Built-in tracker integration (JSON, linear, etc.)

## Installation

### Prerequisites

Ralph TUI requires **Bun >= 1.0.0** as its runtime:

```bash
curl -fsSL https://bun.sh/install | bash
bun --version  # Should output 1.0.0 or higher
```

### Install Ralph TUI

```bash
bun install -g ralph-tui
```

## Configuration

### Project Configuration

Swift DesignOS includes a `.ralph-tui/` directory with `config.toml`:

```toml
# Ralph TUI Configuration
# Generated by setup wizard
# See: ralph-tui config help

tracker = "json"
agent = "opencode"
maxIterations = 35
autoCommit = true

[trackerOptions]
[agentOptions]
```

### Configuration Layers

Ralph TUI uses a layered configuration system:

1. **Global Config**: `~/.config/ralph-tui/config.toml`
   - User-wide defaults for all projects

2. **Project Config**: `.ralph-tui/config.toml` (project root)
   - Project-specific settings that override global defaults

3. **CLI Flags**: Command-line options that override everything

### Configuration Options

- **tracker**: Type of task tracker (`json`, `linear`, etc.)
- **agent**: AI coding agent to use (`opencode`, `claude-code`, etc.)
- **maxIterations**: Maximum number of agent iterations per task
- **autoCommit**: Whether to auto-commit changes after task completion

## Usage

### Start Ralph TUI

```bash
ralph
```

This opens the TUI interface where you can:

- View and manage tasks
- Monitor agent execution
- Track progress in real-time
- Review logs and outputs

### Common Commands

```bash
# Initialize Ralph TUI in current project
ralph init

# View configuration
ralph config show

# Run a specific task
ralph run <task-id>

# View task history
ralph history

# Clean up caches
ralph clean
```

## Integration with Swift DesignOS

### Workflow

1. **Product Planning**: Use Ralph to break down features into atomic tasks
2. **AI Execution**: Ralph orchestrates OpenCode agent to implement tasks
3. **Auto-Commit**: Changes are automatically committed (if enabled)
4. **Tracking**: All activity is tracked in JSON format

### Files and Directories

```
.swift-design-os/
├── .ralph-tui/
│   └── config.toml          # Project configuration
├── .gitignore               # Includes Ralph TUI caches
└── Package.swift            # SPM package definition
```

### Git Configuration

The `.gitignore` file includes:

```gitignore
# Ralph TUI
# Agent-specific caches and logs (keep config.toml)
.ralph-tui/cache/
.ralph-tui/logs/
.ralph-tui/sessions/
```

This ensures only the configuration is tracked, while caches and logs are excluded.

## Advanced Features

### Custom Templates

Create custom prompt templates for Ralph:

```bash
# Initialize a custom template
ralph template init
```

This creates `.ralph-tui-prompt.hbs` in your project root.

### Task Dependencies

Ralph automatically manages task dependencies and ensures tasks are executed in the correct order.

### Quality Gates

Each task can have quality gates built-in, ensuring code meets standards before completion.

## Troubleshooting

### Ralph not found

Ensure Bun is installed and Ralph is in your PATH:

```bash
which ralph  # Should show Ralph installation path
bun --version  # Should be >= 1.0.0
```

### Agent connection issues

Check your agent configuration:

```bash
ralph config show
opencode --version
```

### Cache issues

Clear Ralph caches:

```bash
ralph clean
```

## Resources

- **Official Docs**: https://ralph-tui.com
- **GitHub**: https://github.com/subsy/ralph-tui
- **OpenCode Agent**: https://opencode.ai

## Notes

- Ralph TUI is optional for Swift DesignOS development
- The TUI provides better visibility than direct CLI usage
- Configuration can be customized per project requirements
- Auto-commit feature creates git commits automatically after task completion
